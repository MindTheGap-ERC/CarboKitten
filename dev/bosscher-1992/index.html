<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bosscher and Schlager 1992 · CarboKitten</title><meta name="title" content="Bosscher and Schlager 1992 · CarboKitten"/><meta property="og:title" content="Bosscher and Schlager 1992 · CarboKitten"/><meta property="twitter:title" content="Bosscher and Schlager 1992 · CarboKitten"/><meta name="description" content="Documentation for CarboKitten."/><meta property="og:description" content="Documentation for CarboKitten."/><meta property="twitter:description" content="Documentation for CarboKitten."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CarboKitten</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Bosscher and Schlager 1992</a><ul class="internal"><li><a class="tocitem" href="#Parameters"><span>Parameters</span></a></li><li><a class="tocitem" href="#Growth-Rate"><span>Growth Rate</span></a></li><li><a class="tocitem" href="#Depth-Evolution"><span>Depth Evolution</span></a></li><li><a class="tocitem" href="#Crosssection"><span>Crosssection</span></a></li></ul></li><li><span class="tocitem">CarboCAT</span><ul><li><a class="tocitem" href="../carbocat/">Summary</a></li><li><a class="tocitem" href="../carbocat-ca/">Cellular Automaton</a></li><li><a class="tocitem" href="../ca-with-production/">Model with CA and Production</a></li><li><a class="tocitem" href="../carbocat-transport/">Sediment Transport</a></li></ul></li><li><span class="tocitem">Algorithms</span><ul><li><a class="tocitem" href="../stencils/">Stencils</a></li><li><a class="tocitem" href="../utility/">Utility</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Bosscher and Schlager 1992</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bosscher and Schlager 1992</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MindTheGap-ERC/CarboKitten" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MindTheGap-ERC/CarboKitten/blob/main/docs/transpiled/bosscher-1992.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Carbonate-Production"><a class="docs-heading-anchor" href="#Carbonate-Production">Carbonate Production</a><a id="Carbonate-Production-1"></a><a class="docs-heading-anchor-permalink" href="#Carbonate-Production" title="Permalink"></a></h1><p><strong>reproducing Bosscher &amp; Schlager 1992</strong></p><p>The paper by @Bosscher1992 is an early computer model for simulating reef growth. This paper contains some of the essential ingredients that we find back in CarboCAT. Here we will try to reproduce their results.</p><h2 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h2><blockquote><ul><li>Maximum growth rate <span>$G_m$</span>. The maximum rate of reef growth is in the range of <span>$10-15 {\rm mm\ yr^{-1}}$</span> (Macintyre etal., 1977; Adey, 1978; Davies, 1983).</li><li>Extinction coefficient <span>$k$</span>. This is a measure of the extinction of photosynthetically active radiation (PAR), i.e. light with a wavelength of 400-700 nm.  The value of k for oceanic waters ranges from <span>$0.04$</span> to <span>$0.16\ {\rm m^{-1}}$</span> (Jerlov, 1976); reported values for reef waters also lie within this range (Brakel, 1979; Van den Hoek et al., 1975; Weinberg, 1976; Chalker, 1981; Porter, 1985).</li><li>Surface light intensity <span>$I_0$</span>. The light intensity at the water surface at midday in the tropics lies in the range of <span>$2000-2250\ {\rm \mu E\ m^{-2}s^{-1}}$</span>.</li><li>Saturating light intensity <span>$I_k$</span>. Light saturating intensities are in the range <span>$50-450\ {\rm \mu E\ m^{-2}s^{-1}}$</span>, depending on species and water depth (Chalker, 1981; Wyman et al., 1987). Photoadaptation of reef-building corals has not been taken into account. More generally, light does not become a limiting factor for coral growth until it reaches roughly 10% of its surface value (B. E. Chalker, in Done, 1983).</li></ul></blockquote><p><em>from BS92</em></p><h2 id="Growth-Rate"><a class="docs-heading-anchor" href="#Growth-Rate">Growth Rate</a><a id="Growth-Rate-1"></a><a class="docs-heading-anchor-permalink" href="#Growth-Rate" title="Permalink"></a></h2><p>The growth rate is</p><p class="math-container">\[g(w) = g_m \tanh\left({{I_0 e^{-kw}} \over {I_k}}\right),\]</p><div class="noweb-label">⪡carbonate-production⪢≣</div><pre><code class="language- julia hljs">g(gₘ, I₀, Iₖ, k, w) = gₘ * tanh(I₀/Iₖ * exp(-w * k))</code></pre><div class="noweb-label">⪡b92-model⪢≣</div><pre><code class="language- julia hljs">&lt;&lt;carbonate-production&gt;&gt;

struct Parameters
     I₀::Float64
     Iₖ::Float64
     k::Float64
     gₘ::Float64
end

g(p::Parameters, w) = g(p.gₘ, p.I₀, p.Iₖ, p.k, w)</code></pre><p>where <span>$w$</span> is the water depth in meters, <span>$g_m$</span> is the maximum growth rate in <span>${\rm m}\ {\rm My}^-1$</span>, <span>$I_0$</span> is surface light intensity, <span>$I_k$</span> is saturation light intensity, and <span>$k$</span> is the extinction coefficient. We have exponential decay of light intensity as we get to deeper water, and the carbonate factories respond to light intensity through a <span>$\tanh$</span> (hyperbolic tangent function). This is by no means an exact relation, rather the <span>$\tanh$</span> function interpolates smoothly between one and zero. We specify a maximum growth rate and a typical intensity at which the species is no longer productive.</p><p>The shape of <span>$\tanh \circ \exp$</span> look like this:</p><p><img src="../fig/tanh.svg" alt/></p><p>Notice that the numbers inside the exponential need to be unit-free, so does the output. The value of <span>$\tanh \circ \exp$</span> at a depth of 0 is <span>$0.7615\dots$</span>. This does not make much sense, as I believe we should start at a value of 1 at the surface. By setting <span>$I_0 / I_k$</span> to some value <span>$&gt;1$</span> this can be alleviated, but it changes the interpretation of the constants a little. The idea is that above a certain insolation, light is not the limiting factor to the rate of photosynthesis.</p><p>To reproduce Figure 2 in B13, I had to change the values for <span>$g_m$</span> to 500, 250, and 125 respectively, the other values from Table 2 remained the same. I guess this was done for illustration purposes.</p><p><img src="../fig/b13-fig2.svg" alt/></p><details><summary>Plotting code</summary><div class="noweb-label">file:<i>examples/plot-tanh.gnuplot</i></div><pre><code class="language- gnuplot hljs">set term svg size 700, 300 font &quot;sans serif, 14&quot; linewidth 1.5
set xrange [-5:10]
set yrange [-0.1:1.1]
set grid
set key outside
set xlabel &quot;x&quot;
set ylabel &quot;y&quot;
plot tanh(exp(-x)) lc rgb &#39;black&#39;, tanh(exp(4)*exp(-x)), tanh(exp(-0.5*x))</code></pre><div class="noweb-label">file:<i>examples/burgess2013-fig2.gnuplot</i></div><pre><code class="language- gnuplot hljs">set term svg size 500, 600 font &quot;sans serif,14&quot; linewidth 1.5
set trange [0:100]
set yrange [100:0]
set xrange [-20:520]
set parametric
set key right bottom
set grid
set ylabel &quot;Water depth (m)&quot;
set xlabel &quot;Production rates&quot;
plot 500*tanh(6.7 * exp(-0.8 * t)), t title &#39;Carbonate factory 1&#39;, \
     250*tanh(6.7 * exp(-0.1 * t)), t title &#39;Carbonate factory 2&#39;, \
     125*tanh(6.7 * exp(-0.005 * t)), t title &#39;Carbonate factory 3&#39;</code></pre></details><h2 id="Depth-Evolution"><a class="docs-heading-anchor" href="#Depth-Evolution">Depth Evolution</a><a id="Depth-Evolution-1"></a><a class="docs-heading-anchor-permalink" href="#Depth-Evolution" title="Permalink"></a></h2><p>The use of water depth in both BS92 and B13 can be a bit confusing. Plots are shown up-side-down and little is done to disambiguate depth with sea level rising or lowering, or sediment accreting. Growth in deposition should give shallower sea bed. BS92 write <span>$w = (h_0 + h(t)) - (s_0 + s(t))$</span>. Actually <span>$s_0$</span> is best set to 0, or simply included into <span>$s(t)$</span> and <span>$h_0$</span> can be replaced with setting <span>$h(t=0) = h_0$</span>. Then, as we have the growth rate as a function of water depth <span>$g(w)$</span>, we can say</p><p>[<span>$\partial_t h = -g_m {\rm tanh}\left[\frac{I_0}{I_k} \exp(-k (h - s(t)))\right].$</span>]{#eq:growth-eqn}</p><div class="noweb-label">⪡b92-model⪢⊞</div><pre><code class="language- julia hljs">function model(p::Parameters, s, t_end::Float64, h₀::Float64)
     ∂h(h::Float64, _, t::Float64) = let w = h - s(t)
          w &gt;= 0.0 ? -g(p, h - s(t)) : 0.0
     end
     ode = ODEProblem(∂h, h₀, (0.0, t_end), Nothing)
     solve(ode, Euler(), dt=10.0, reltol=1e-6, saveat=1000.0)
end</code></pre><p>It seems Eq. 5 in BS92 (the most important equation in the paper mind you!) is missing both a minus sign and a set of parentheses. Also, we should remark that at negative depth (subareal exposure) we should halt all growth.</p><h2 id="Crosssection"><a class="docs-heading-anchor" href="#Crosssection">Crosssection</a><a id="Crosssection-1"></a><a class="docs-heading-anchor-permalink" href="#Crosssection" title="Permalink"></a></h2><p>The most impressive result in BS92 is the last figure. They show an input curve for <span>$s(t)$</span> but give no functional description. The curve starts with a linear drop from 0 to 120m depth over a time of 20000 years, then slowly rises with <span>$s(t) = a +  bt + A \sin(2\pi t / P)$</span>, with a period <span>$P = \sim 15-20 {\rm kyr}$</span>, amplitude <span>$A = \sim 40 {\rm m}$</span>. It might be easiest to take a screenshot of the PDF and convert the graph into a table.</p><details><summary>Extracting Sealevel Curve from an image</summary><div class="noweb-label">file:<i>src/BS92/fig8-sealevel.jl</i></div><pre><code class="language- julia hljs">module Script
    using Images
    using DataFrames
    using CSV

    function main()
        img = load(&quot;data/bs92-sealevel-input.png&quot;)
        img_gray = Gray.(img)
        signal = 1.0 .- channelview(img_gray)
        signal ./= sum(signal; dims=[1])
        (n_y, n_x) = size(signal)
        y = sum(signal .* (1:n_y); dims=[1]) / n_y * 200.0
        df = DataFrame(
            time = LinRange(0.0, 80_000.0, n_x),
            depth = y[1, :])
        CSV.write(&quot;data/bs92-sealevel-curve.csv&quot;, df)
    end
end

Script.main()</code></pre></details><p>Using <code>DifferentialEquations.jl</code> we can integrate Equation @eq:growth-eqn. Interestingly, the only integrator that gave me noise free results is <code>Euler</code>. This may be due to the sudden shut-down of production at <span>$w = 0$</span>.</p><div class="noweb-label">file:<i>src/BS92.jl</i></div><pre><code class="language- julia hljs">module BS92

using DifferentialEquations
using CSV
using DataFrames
using Interpolations

&lt;&lt;b92-model&gt;&gt;

function sealevel_curve()
     data = DataFrame(CSV.File(pkgdir(BS92, &quot;data&quot;, &quot;bs92-sealevel-curve.csv&quot;)))
     linear_interpolation(data.time, data.depth)
end

struct Scenario
     param::Parameters
     sealevel
     t_end::Float64
end

model(s::Scenario, h₀::Float64) = model(s.param, s.sealevel, s.t_end, h₀)

SCENARIO_A = Scenario(
     Parameters(2000.0, 250.0, 0.05, 0.005),
     sealevel_curve(),
     80_000.0)

end</code></pre><p>Finally, we can try to reproduce figure 8 in BS92.</p><p><img src="../fig/bs92-fig8.svg" alt/></p><p>Note the simplicity of this result: there is no dependency on space, only on the initial depth <span>$h_0$</span>.</p><details><summary>Plotting code</summary><div class="noweb-label">file:<i>examples/bosscher-schlager-1992.jl</i></div><pre><code class="language- julia hljs">module Script
     using CarboKitten.BS92
     using CairoMakie

     function main()
          h0 = LinRange(0, 200, 101)
          result = hcat([BS92.model(BS92.SCENARIO_A, h).u for h in h0]...)
          t = LinRange(0, 80_000, 81)

          fig = Figure(resolution=(600,900))
          ax = Axis(fig[1,1], xlabel=&quot;initial depth (m)&quot;, ylabel=&quot;depth (m)&quot;, yreversed=true)
          for l in eachrow(result)
               lines!(ax, h0, vec(l); color=:steelblue4, linewidth=0.5)
          end
          ax = Axis(fig[2,1], xlabel=&quot;time (years)&quot;, ylabel=&quot;depth (m)&quot;, yreversed=true)
          lines!(ax, t, BS92.SCENARIO_A.sealevel(t); color=:steelblue4)

          save(&quot;docs/src/fig/bs92-fig8.svg&quot;, fig)
     end
end

Script.main()</code></pre></details></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../carbocat/">Summary »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.0 on <span class="colophon-date" title="Thursday 5 October 2023 17:41">Thursday 5 October 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
